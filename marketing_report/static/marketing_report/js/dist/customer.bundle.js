(()=>{"use strict";function e(e){return fetch(e).then((e=>e.json()))}const t=document.querySelector(".report-button"),o=document.querySelector(".btn-export"),n=document.querySelector(".current-date"),c=document.querySelector(".years"),r=document.querySelector(".cust__content"),a=document.querySelector(".dict-block__form-input"),l=document.querySelector(".modal-close");async function d(t,o,r){let a=t.dataset.last;a||(a=0);const l=document.querySelector(".cust__content");let d;delete t.dataset.last;const u=l.querySelector(".dict-block__row_hidden"),i=`/marketing/customers_current/${n.value}/${c.value}/${o}/${r}`,m=await e(i);let _=0;const y=[];for(const e of m)_++,d=u.cloneNode(!0),s(e,d),d.classList.remove("dict-block__row_hidden"),50===_&&(d.dataset.last=Number.parseInt(a)+50),l.appendChild(d),y.push(d);return y}function s(t,o){const n=o.querySelectorAll('div[data-field]:not([data-field = ""])');o.dataset.id=t.id;for(const e of n){const o=e.dataset.field;e.textContent=t[o]}o.addEventListener("click",(()=>async function(t,o){let n,c;const r=document.querySelector("#cust-list"),a=r.querySelector(".cust__list");a.innerHTML="",r.querySelector(".import-file-modal__header").textContent=o,(await e(`/marketing/show_customers_of_group/${t}`)).forEach((e=>{n=document.createElement("div"),n.classList.add("import-file-modal__content"),c=document.createElement("div"),c.textContent=e.name,n.appendChild(c),c=document.createElement("div"),c.textContent=e.date_last,n.appendChild(c),a.appendChild(n)})),r.style.display="block",setTimeout((()=>{r.classList.add("import-file-modal_open","wide")}),0)}(t.id,t.name)))}t.addEventListener("click",(async e=>{e.preventDefault();const t=document.querySelector("#customer-0");r.querySelectorAll(".cust__row").forEach((e=>{e.classList.contains("dict-block__row_hidden")||e.remove()})),await d(t,"default",0)})),r.addEventListener("mouseover",(async e=>{const t=r.querySelector('div[data-last]:not([data-last = ""])');if(t){const o=t.dataset.last;if(e.target===t){let e=function(){let e="";return a&&(e=a.value.replace(" ","_")),""===e&&(e="default"),e}();e||(e=""),await d(t,e,o)}}})),o.addEventListener("click",(()=>function(){const e=document.querySelector("#export-form");e.querySelector("#years").value=c.value,e.querySelector("#date").value=n.value,e.submit()}())),l.addEventListener("click",(()=>function(){const e=document.querySelector("#cust-list");setTimeout((()=>{e.classList.remove("import-file-modal_open","wide")}),0),e.style.display="none"}()))})();