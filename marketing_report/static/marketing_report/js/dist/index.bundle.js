(()=>{"use strict";const e={colorScheme:"ColorScheme",color:"Color",printType:"PrintType",matrixType:"MatrixType",crmType:"CrmType",customerType:"CustomerType",customerGroup:"CustomerGroup",customer:"Customer",businessUnit:"BusinessUnit",typeGroup:"TypeGroup",fedRegion:"FedRegion",regionToFedRegion:"RegionToFedRegion",customerArea:"CustomerArea",detailName:"DetailName",detailInGoods:"DetailInGoods",goods:"Goods",producer:"Producer",color_scheme:"ColorScheme",print_type:"PrintType",matrix_type:"MatrixType",crm_type:"CrmType",customer_type:"CustomerType",customer_group:"CustomerGroup",business_unit:"BusinessUnit",type_group:"TypeGroup",fed_region:"FedRegion",region_to_fed_region:"RegionToFedRegion",customer_area:"CustomerArea",detail_in_goods:"DetailInGoods",detail_name:"DetailName",detail:"DetailInGoods",production:"ProductionReport"};function t(e){return fetch(e).then((e=>e.json()))}async function a(s){const i=s.closest(".dropdown"),n=i.closest("form"),c=i.querySelector(".dropdown__hidden").name,d=n?n.querySelector(`[data-filter="${c}"]`):null;if(i.querySelector(".dropdown__input").value=s.textContent.trim().replace(/\s+/g," "),i.querySelector(".dropdown__input").dataset.value=s.textContent.trim().replace(/\s+/g," "),i.querySelector(".dropdown__hidden").value=s.dataset.value,s.parentElement.classList.remove("visible"),d){const i=d.closest(".report_dropdown").querySelector("ul");i.innerHTML="",d.value="";const n=d.name;i.closest(".report_dropdown").querySelector(".dropdown__input").value="",i.closest(".report_dropdown").querySelector(".dropdown__input").dataset.value="";const r=`/marketing/dictionary_json_filter/${e[n]}/${e[c]}/${Number.parseInt(s.dataset.value)}`,l=await t(r);!function(e,t){let s;t.forEach((t=>{s=document.createElement("li"),s.onclick=async function(e){e.stopPropagation(),await a(e.target)},s.dataset.value=Object.keys(t)[0],s.textContent=Object.values(t)[0],e.appendChild(s)}))}(i,JSON.parse(l))}}async function s(e){const t=e.parentElement.parentElement,s=t.querySelector(".dropdown__hidden").value,i=e.dataset.value;await a(e);const n=document.querySelector("#money-reports").value.split(","),c=t.parentElement.querySelector('[id^="parameter-select"]').parentElement.querySelector(".dropdown__content");let d;n.includes(s)&&!n.includes(i)?(d=document.querySelector("#time-arguments"),c.innerHTML=d.innerHTML,c.querySelectorAll("li").forEach((e=>e.addEventListener("click",(e=>a(e.target))))),await a(c.querySelector("li"))):!n.includes(s)&&n.includes(i)&&(d=document.querySelector("#money-arguments"),c.innerHTML=d.innerHTML,c.querySelectorAll("li").forEach((e=>e.addEventListener("click",(e=>a(e.target))))),await a(c.querySelector("li")))}function i(e){const t=e.report.period_data,a="abc__"+t.length,s=document.createElement("div");return s.classList.add("abc",a,"active","abc__period-row"),s.insertAdjacentHTML("afterbegin","<div>название</div><div>показатели</div>"),t.forEach((e=>{let t=document.createElement("div");t.textContent=e.name,t.classList.add("abc__digit"),s.appendChild(t)})),s.insertAdjacentHTML("beforeend",'<div class="abc__digit">всего</div>'),[t,a,s]}function n(){const e=document.createElement("div");e.classList.add("abc","abc__parameter-row");const t=Date.now(),a=`\n    <p>параметр:</p>\n    <span>\n    <input type="checkbox" id="sales-vat-${t}" checked class="sales-vat-check">\n    <label for="sales-vat-${t}">продажи с НДС</label>\n    </span>\n    <span>\n    <input type="checkbox" id="sales-${t}" class="sales-check">\n    <label for="sales-${t}">продажи без НДС</label>\n    </span>\n    <span>\n    <input type="checkbox" id="profit-${t}" class="profit-check">\n    <label for="profit-${t}">прибыль</label>\n    </span>\n    <span>\n    <input type="checkbox" id="quantity-${t}" class="quantity-check">\n    <label for="quantity-${t}">количество единиц</label>\n    </span>\n    <span>\n    <input type="checkbox" id="no-sales-${t}" class="no-sales-check">\n    <label for="no-sales-${t}">количество продаж</label>\n    </span>\n    <span>\n    <input type="checkbox" id="average-check-${t}" class="average-check-check">\n    <label for="average-check-${t}">средний чек</label>\n    </span>\n    `;let s;return e.insertAdjacentHTML("afterbegin",a),s=e.closest("section"),e.querySelector(".sales-vat-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".sales-vat").forEach((e=>c(e,t.target)))})),e.querySelector(".sales-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".sales").forEach((e=>c(e,t.target)))})),e.querySelector(".profit-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".profit").forEach((e=>c(e,t.target)))})),e.querySelector(".quantity-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".quantity").forEach((e=>c(e,t.target)))})),e.querySelector(".no-sales-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".no-sales").forEach((e=>c(e,t.target)))})),e.querySelector(".average-check-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".average-check").forEach((e=>c(e,t.target)))})),e}function c(e,t){t.checked?e.style.display="block":e.style.display="none"}function d(e){const t=document.createElement("div");t.appendChild(function(){const e=document.createElement("div");e.classList.add("abc","abc__parameter-row");const t=Date.now(),a=`\n    <p>параметр:</p>\n    <span>\n        <input type="checkbox" id="sales-vat-${t}" class="sales-vat-check" checked>\n        <label for="sales-vat-${t}">продажи без НДС</label>\n    </span>\n    <span>\n        <input type="checkbox" id="quantity-${t}" class="quantity-check">\n        <label for="quantity-${t}">количество единиц</label>\n    </span>\n    <span>\n        <input type="checkbox" id="no-sales-${t}" class="no-sales-check">\n        <label for="no-sales-${t}">количество продаж</label>\n    </span>\n    <span>\n        <input type="checkbox" id="price-${t}" class="price-check">\n        <label for="price-${t}">средняя цена</label>\n    </span>\n    <span>\n        <input type="checkbox" id="average-quantity-${t}" class="average-quantity-check">\n        <label for="average-quantity-${t}">среднее количество</label>\n    </span>\n    <span>\n        <input type="checkbox" id="min-quantity-${t}" class="min-quantity-check">\n        <label for="min-quantity${t}">минимальное количество</label>\n    </span>\n    `;let s;return e.insertAdjacentHTML("afterbegin",a),s=e.closest("section"),e.querySelector(".sales-vat-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".sales-vat").forEach((e=>c(e,t.target)))})),e.querySelector(".quantity-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".quantity").forEach((e=>c(e,t.target)))})),e.querySelector(".no-sales-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".no-sales").forEach((e=>c(e,t.target)))})),e.querySelector(".price-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".price").forEach((e=>c(e,t.target)))})),e.querySelector(".average-quantity-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".average-quantity").forEach((e=>c(e,t.target)))})),e.querySelector(".min-quantity-check").addEventListener("change",(t=>{s=e.closest("section"),s.querySelectorAll(".min-quantity").forEach((e=>c(e,t.target)))})),e}());const a=i(e),s=a[0],n=a[1],d=a[2];return t.appendChild(d),e.report.report_data.items.forEach((e=>{r(t,n,s,e,0)})),t}function r(e,t,a,s,i){const n=document.createElement("details"),c=document.createElement("summary");let d;c.classList.add("abc",t,"abc__summary","margin__"+i),n.appendChild(c),d=s.name,c.insertAdjacentHTML("afterbegin",`<div>${d}</div>\n          <div class="abc__params">\n            <div class="sales-vat small-font">продажи (тыс. руб.)</div>\n            <div class="quantity small-font" >кол-во шт.</div>\n            <div class="no-sales small-font">кол-во продаж</div>\n            <div class="price small-font">средняя цена</div>\n            <div class="average-quantity small-font">ср. кол-во шт</div>\n            <div class="min-quantity small-font">мин. кол-во</div>\n          </div>`),a.forEach((e=>{const t=document.createElement("div");t.classList.add("abc__params"),s.periods.forEach((a=>{a.period__name===e.name&&t.insertAdjacentHTML("beforeend",`\n            <div class="abc__digit sales-vat">${a.goods_total_sales}</div>\n            <div class="abc__digit quantity">${a.goods_total_quantity}</div>\n            <div class="abc__digit no-sales">${a.goods_total_no_sales}</div>\n            <div class="abc__digit price">${a.goods_average_price}</div>        \n            <div class="abc__digit average-quantity">${a.goods_average_sales_quantity}</div>        \n            <div class="abc__digit min-quantity">${a.goods_minimal_quantity}</div>        \n                `),c.appendChild(t)}))})),c.insertAdjacentHTML("beforeend",`\n    <div class="abc__params">\n        <div class="abc__digit sales-vat">${s.totals.goods_total_sales}</div>\n        <div class="abc__digit quantity">${s.totals.goods_total_quantity}</div>\n        <div class="abc__digit no-sales">${s.totals.goods_total_no_sales}</div>\n        <div class="abc__digit price">${s.totals.goods_average_price}</div>        \n        <div class="abc__digit average-quantity">${s.totals.goods_average_sales_quantity}</div>        \n        <div class="abc__digit min-quantity">${s.totals.goods_minimal_quantity}</div>\n    </div>        \n    `),e.appendChild(n);const l=i+1;void 0!==s.items&&s.items.forEach((e=>r(n,t,a,e,l)))}function l(e){const t=document.createElement("div");t.classList.add("report-list__row");const a=`\n                <input type="text" value="${e.id}" hidden>\n                <div>${e.date}</div>\n                <div>${e.report.report_name}</div>\n                <div>${e.report.period}</div>\n                <div>c&nbsp;${e.report.date_begin}</div>\n                <div>по&nbsp;${e.report.date_end}</div>\n                <div>параметр:&nbsp;${e.report.parameter}</div>\n                <button type="button" class="btn btn-save">удалить</button>`;return t.insertAdjacentHTML("afterbegin",a),t.querySelector(".btn").addEventListener("click",(e=>function(e){e.stopPropagation();const t=e.target.closest(".report-list__row"),a=t.querySelector("input").value;t.remove();let s=JSON.parse(localStorage.getItem("reports"));for(let e=0;e<s.length;e++)if(s[e].id===Number(a)){s.splice(e,1);break}localStorage.setItem("reports",JSON.stringify(s))}(e))),t.addEventListener("click",(e=>function(e){const t=document.querySelector(".full-content").querySelector(".container"),a=document.createElement("section");a.classList.add("report-body");const s=e.target.closest(".report-list__row").querySelector("input").value,c=JSON.parse(localStorage.getItem("reports"));let r;for(let e=0;e<c.length;e++)if(c[e].id===Number(s)){r=c[e];break}const l=function(e){const t=document.createElement("div");t.classList.add("report-body__title");const a=`\n                <div>${e.report.report_name}</div>\n                <div>дата отч.&nbsp;${e.date}</div>\n                <div>детализация&nbsp;${e.report.period}</div>\n                <div>c&nbsp;${e.report.date_begin}</div>\n                <div>по&nbsp;${e.report.date_end}</div>\n                <div>параметр:&nbsp;${e.report.parameter}</div>\n                <button type="button" class="btn btn-save">закрыть</button>`;t.insertAdjacentHTML("afterbegin",a);const s=t.querySelector(".btn");return s.addEventListener("click",(()=>{s.closest(".report-body").remove()})),t}(r);a.appendChild(l);const o=function(e){let t;switch(e.report.report_name){case"Клиенты ABC - анализ":t=function(e){const t=document.createElement("div");t.appendChild(n());const a=i(e),s=a[0],c=a[1],d=a[2];return t.appendChild(d),e.report.report_data.forEach((e=>{let a,i=document.createElement("details"),n=document.createElement("summary");n.classList.add("abc",c,"abc__summary"),i.appendChild(n),"T"===e.group?(n.classList.add("unit-title"),a="Всего"):a="Группа "+e.group,n.insertAdjacentHTML("afterbegin",`<div>${a}, Клиентов&nbsp;${e.customer_quantity}</div>\n                  <div class="abc__params">\n                    <div class="sales-vat">продажи с НДС</div>\n                    <div class="sales">продажи без НДС</div>\n                    <div class="profit">прибыль</div>\n                    <div class="quantity">кол-во единиц (тыс.)</div>\n                    <div class="no-sales">кол-во продаж</div>\n                    <div class="average-check">средний чек</div>        \n                  </div>`),s.forEach((t=>{const a=document.createElement("div");a.classList.add("abc__params"),e.group_details.forEach((e=>{e.period__name===t.name&&a.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${e.group_sales_with_vat}</div>\n                    <div class="abc__digit sales">${e.group_sales_without_vat}</div>\n                    <div class="abc__digit profit">${e.group_profit}</div>\n                    <div class="abc__digit quantity">${e.group_quantity}</div>\n                    <div class="abc__digit no-sales">${e.group_no_sales}</div>\n                    <div class="abc__digit average-check">${e.group_average_check}</div>        \n                        `),n.appendChild(a)}))})),n.insertAdjacentHTML("beforeend",`<div class="abc__params">\n                    <div class="abc__digit sales-vat">${e.group_sales_with_vat}</div>\n                    <div class="abc__digit sales">${e.group_sales_without_vat}</div>\n                    <div class="abc__digit profit">${e.group_profit}</div>\n                    <div class="abc__digit quantity">${e.group_quantity}</div>\n                    <div class="abc__digit no-sales">${e.group_no_sales}</div>\n                    <div class="abc__digit average-check">${e.group_average_check}</div>        \n                  </div>`),t.appendChild(i),e.customers&&e.customers.forEach((e=>{const t=document.createElement("div");t.classList.add(c,"abc"),t.insertAdjacentHTML("afterbegin",`<div>${e.group_code}</div>\n                  <div class="abc__params">\n                    <div class="sales-vat">продажи с НДС</div>\n                    <div class="sales">продажи без НДС</div>\n                    <div class="profit">прибыль</div>\n                    <div class="quantity">кол-во единиц (тыс.)</div>\n                    <div class="average-check">кол-во продаж</divclass>\n                    <div>средний чек</div>        \n                  </div>`),s.forEach((a=>{const s=document.createElement("div");s.classList.add("abc__params"),e.details.forEach((e=>{e.period_code===a.name&&s.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${e.sales_with_vat_s}</div>\n                    <div class="abc__digit sales">${e.sales_without_vat_s}</div>\n                    <div class="abc__digit profit">${e.profit_s}</div>\n                    <div class="abc__digit quantity">${e.quantity_s}</div>\n                    <div class="abc__digit no-sales">${e.no_sales_s}</div>\n                    <div class="abc__digit average-check">${e.average_check_s}</div>        \n                        `),t.appendChild(s)}))})),t.insertAdjacentHTML("beforeend",`<div class="abc__params">\n                    <div class="abc__digit sales-vat">${e.total_sales_with_vat}</div>\n                    <div class="abc__digit sales">${e.total_sales_without_vat}</div>\n                    <div class="abc__digit profit">${e.total_profit}</div>\n                    <div class="abc__digit quantity">${e.total_quantity}</div>\n                    <div class="abc__digit no-sales">${e.total_no_sales}</div>\n                    <div class="abc__digit average-check">${e.average_check}</div>        \n                  </div>`),i.appendChild(t)}))})),t}(e);break;case"Клиенты Миграции клиентов":t=function(e){const t=document.createElement("div"),a=i(e),s=a[1],n=a[2];t.appendChild(n);const c=document.createElement("details"),d=document.createElement("summary");d.classList.add("abc",s,"abc__summary"),c.appendChild(d);const r=document.createElement("div");r.classList.add("abc",s,"abc__summary"),r.insertAdjacentHTML("afterbegin","<div></div><div></div>"),c.appendChild(r);const l=document.createElement("details"),o=document.createElement("summary");o.classList.add("abc",s,"abc__summary"),l.appendChild(o);const v=document.createElement("div");v.classList.add("abc",s,"abc__summary"),v.insertAdjacentHTML("afterbegin","<div></div><div></div>"),l.appendChild(v);const _=document.createElement("details"),p=document.createElement("summary");p.classList.add("abc",s,"abc__summary"),_.appendChild(p);const u=document.createElement("div");return u.classList.add("abc",s,"abc__summary"),u.insertAdjacentHTML("afterbegin","<div></div><div></div>"),_.appendChild(u),d.insertAdjacentHTML("afterbegin",'<div></div><div class="abc__params">количество клиентов</div>'),o.insertAdjacentHTML("afterbegin",'<div></div><div class="abc__params">новые клиенты</div>'),p.insertAdjacentHTML("afterbegin",'<div></div><div class="abc__params">потеряно клиентов</div>'),e.report.report_data.forEach((e=>{d.insertAdjacentHTML("beforeend",`<div class="abc__digit">${e.currentQuant}</div>`),o.insertAdjacentHTML("beforeend",`<div class="abc__digit">${e.newQuant}</div>`),p.insertAdjacentHTML("beforeend",`<div class="abc__digit">${e.finishQuant}</div>`);let t="",a="",s="";e.customersFinished.forEach((e=>{s+=`\n                <p class="abc__migration-clients">${e.name}</p>\n                <p class="abc__migration-clients">${e.date}</p>`})),e.customersNew.forEach((e=>{a+=`\n                <p class="abc__migration-clients">${e.name}</p>\n                <p class="abc__migration-clients">${e.date}</p>`})),e.customersCurrent.forEach((e=>{t+=`\n                <p class="abc__migration-clients">${e.name}</p>\n                <p class="abc__migration-clients">${e.date}</p>`})),u.insertAdjacentHTML("beforeend",`<div>${s}</div>`),v.insertAdjacentHTML("beforeend",`<div>${a}</div>`),r.insertAdjacentHTML("beforeend",`<div>${t}</div>`)})),d.insertAdjacentHTML("beforeend",'<div class="abc__digit">-</div>'),o.insertAdjacentHTML("beforeend",'<div class="abc__digit">-</div>'),p.insertAdjacentHTML("beforeend",'<div class="abc__digit">-</div>'),r.insertAdjacentHTML("beforeend","<div></div>"),v.insertAdjacentHTML("beforeend","<div></div>"),u.insertAdjacentHTML("beforeend","<div></div>"),t.appendChild(c),t.appendChild(l),t.appendChild(_),t}(e);break;case"Клиенты Типы и география":t=function(e){const t=document.createElement("div");t.appendChild(n());const a=i(e),s=a[0],c=a[1],d=a[2];return t.appendChild(d),e.report.report_data.forEach((e=>{let a=document.createElement("details"),i=document.createElement("summary");i.classList.add("abc",c,"abc__summary","unit-title"),a.appendChild(i);const n="Регион "+Object.keys(e)[0];let d;i.insertAdjacentHTML("afterbegin",`<div>${n}</div>\n                  <div class="abc__params">\n                    <div class="sales-vat">продажи с НДС</div>\n                    <div class="sales">продажи без НДС</div>\n                    <div class="profit">прибыль</div>\n                    <div class="quantity">кол-во единиц (тыс.)</div>\n                    <div class="no-sales">кол-во продаж</div>\n                    <div class="average-check">средний чек</div>        \n                  </div>`),s.forEach((t=>{const a=document.createElement("div");let s;a.classList.add("abc__params"),Object.values(e)[0].forEach((e=>{Object.keys(e).includes("region_sales")&&(s=e.region_sales)})),s.forEach((e=>{e.period__name===t.name&&a.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${e.sales_with_vat_s}</div>\n                    <div class="abc__digit sales">${e.sales_without_vat_s}</div>\n                    <div class="abc__digit profit">${e.profit_s}</div>\n                    <div class="abc__digit quantity">${e.quantity_s}</div>\n                    <div class="abc__digit no-sales">${e.no_sales_s}</div>\n                    <div class="abc__digit average-check">${e.average_check_s}</div>        \n                        `),i.appendChild(a)}))})),Object.values(e)[0].forEach((e=>{Object.keys(e).includes("total_sales")&&(d=e.total_sales[0])})),i.insertAdjacentHTML("beforeend",`<div class="abc__params">\n                    <div class="abc__digit sales-vat">${d.sales_with_vat_s}</div>\n                    <div class="abc__digit sales">${d.sales_without_vat_s}</div>\n                    <div class="abc__digit profit">${d.profit_s}</div>\n                    <div class="abc__digit quantity">${d.quantity_s}</div>\n                    <div class="abc__digit no-sales">${d.no_sales_s}</div>\n                    <div class="abc__digit average-check">${d.average_check_s}</div>        \n                  </div>`),t.appendChild(a),Object.values(e)[0].forEach((e=>{if(1!==Object.keys(e).length){let t=document.createElement("details"),i=document.createElement("summary");i.classList.add("abc",c,"abc__summary"),i.insertAdjacentHTML("afterbegin",`<div>${Object.keys(e)[0]}</div>\n                        <div class="abc__params">\n                        <div class="sales-vat">продажи с НДС</div>\n                        <div class="sales">продажи без НДС</div>\n                        <div class="profit">прибыль</div>\n                        <div class="quantity">кол-во единиц (тыс.)</div>\n                        <div class="no-sales">кол-во продаж</div>\n                        <div class="average-check">средний чек</div>        \n                      </div>`),t.appendChild(i),a.appendChild(t),s.forEach((t=>{const a=document.createElement("div");a.classList.add("abc__params"),e.unit_sales.forEach((e=>{e.period__name===t.name&&a.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${e.sales_with_vat_s}</div>\n                    <div class="abc__digit sales">${e.sales_without_vat_s}</div>\n                    <div class="abc__digit profit">${e.profit_s}</div>\n                    <div class="abc__digit quantity">${e.quantity_s}</div>\n                    <div class="abc__digit no-sales">${e.no_sales_s}</div>\n                    <div class="abc__digit average-check">${e.average_check_s}</div>        \n                        `),i.appendChild(a)}))})),i.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${e.total_sales[0].sales_with_vat_s}</div>\n                        <div class="abc__digit sales">${e.total_sales[0].sales_without_vat_s}</div>\n                        <div class="abc__digit profit">${e.total_sales[0].profit_s}</div>\n                        <div class="abc__digit quantity">${e.total_sales[0].quantity_s}</div>\n                        <div class="abc__digit no-sales">${e.total_sales[0].no_sales_s}</div>\n                        <div class="abc__digit average-check">${e.total_sales[0].average_check_s}\n                    </div>`),Object.values(e)[0].forEach((e=>{let a=document.createElement("div");a.classList.add("abc",c),t.appendChild(a),a.insertAdjacentHTML("afterbegin",`<div>${Object.keys(e)[0]}</div>\n                        <div class="abc__params">\n                        <div class="sales-vat">продажи с НДС</div>\n                        <div class="sales">продажи без НДС</div>\n                        <div class="profit">прибыль</div>\n                        <div class="quantity">кол-во единиц (тыс.)</div>\n                        <div class="no-sales">кол-во продаж</div>\n                        <div class="average-check">средний чек</div>        \n                      </div>`),s.forEach((t=>{const s=document.createElement("div");s.classList.add("abc__params"),Object.values(e)[0].forEach((e=>{e.period__name===t.name&&s.insertAdjacentHTML("beforeend",`\n                                        <div class="abc__digit sales-vat">${e.sales_with_vat_s}</div>\n                                        <div class="abc__digit sales">${e.sales_without_vat_s}</div>\n                                        <div class="abc__digit profit">${e.profit_s}</div>\n                                        <div class="abc__digit quantity">${e.quantity_s}</div>\n                                        <div class="abc__digit no-sales">${e.no_sales_s}</div>\n                                        <div class="abc__digit average-check">${e.average_check_s}</div>        \n                                    `),a.appendChild(s)}))}))}))}}))})),t}(e);break;case"Клиенты Направления бизнеса":t=function(e){const t=document.createElement("div");t.appendChild(n());const a=i(e),s=a[0],c=a[1],d=a[2];let r;return t.appendChild(d),e.report.report_data.forEach((e=>{e.unitReport.forEach((a=>{let i=document.createElement("details"),n=document.createElement("summary");n.classList.add("abc",c,"abc__summary"),i.appendChild(n),"T"===a.group?(n.classList.add("unit-title"),r=e.unit):r="Группа "+a.group,n.insertAdjacentHTML("afterbegin",`<div>${r}, Клиентов&nbsp;${a.customer_quantity}</div>\n                  <div class="abc__params">\n                    <div class="sales-vat">продажи с НДС</div>\n                    <div class="sales">продажи без НДС</div>\n                    <div class="profit">прибыль</div>\n                    <div class="quantity">кол-во единиц (тыс.)</div>\n                    <div class="no-sales">кол-во продаж</div>\n                    <div class="average-check">средний чек</div>        \n                  </div>`),s.forEach((e=>{const t=document.createElement("div");t.classList.add("abc__params"),a.group_details.forEach((a=>{a.period__name===e.name&&t.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${a.group_sales_with_vat}</div>\n                    <div class="abc__digit sales">${a.group_sales_without_vat}</div>\n                    <div class="abc__digit profit">${a.group_profit}</div>\n                    <div class="abc__digit quantity">${a.group_quantity}</div>\n                    <div class="abc__digit no-sales">${a.group_no_sales}</div>\n                    <div class="abc__digit average-check">${a.group_average_check}</div>        \n                        `),n.appendChild(t)}))})),n.insertAdjacentHTML("beforeend",`<div class="abc__params">\n                    <div class="abc__digit sales-vat">${a.group_sales_with_vat}</div>\n                    <div class="abc__digit sales">${a.group_sales_without_vat}</div>\n                    <div class="abc__digit profit">${a.group_profit}</div>\n                    <div class="abc__digit quantity">${a.group_quantity}</div>\n                    <div class="abc__digit no-sales">${a.group_no_sales}</div>\n                    <div class="abc__digit average-check">${a.group_average_check}</div>        \n                  </div>`),t.appendChild(i),a.customers&&a.customers.forEach((e=>{const t=document.createElement("div");t.classList.add(c,"abc"),t.insertAdjacentHTML("afterbegin",`<div>${e.group_code}</div>\n                  <div class="abc__params">\n                    <div class="sales-vat">продажи с НДС</div>\n                    <div class="sales">продажи без НДС</div>\n                    <div class="profit">прибыль</div>\n                    <div class="quantity">кол-во единиц (тыс.)</div>\n                    <div class="average-check">кол-во продаж</divclass>\n                    <div>средний чек</div>        \n                  </div>`),s.forEach((a=>{const s=document.createElement("div");s.classList.add("abc__params"),e.details.forEach((e=>{e.period_code===a.name&&s.insertAdjacentHTML("beforeend",`\n                    <div class="abc__digit sales-vat">${e.sales_with_vat_s}</div>\n                    <div class="abc__digit sales">${e.sales_without_vat_s}</div>\n                    <div class="abc__digit profit">${e.profit_s}</div>\n                    <div class="abc__digit quantity">${e.quantity_s}</div>\n                    <div class="abc__digit no-sales">${e.no_sales_s}</div>\n                    <div class="abc__digit average-check">${e.average_check_s}</div>        \n                        `),t.appendChild(s)}))})),t.insertAdjacentHTML("beforeend",`<div class="abc__params">\n                    <div class="abc__digit sales-vat">${e.total_sales_with_vat}</div>\n                    <div class="abc__digit sales">${e.total_sales_without_vat}</div>\n                    <div class="abc__digit profit">${e.total_profit}</div>\n                    <div class="abc__digit quantity">${e.total_quantity}</div>\n                    <div class="abc__digit no-sales">${e.total_no_sales}</div>\n                    <div class="abc__digit average-check">${e.average_check}</div>        \n                  </div>`),i.appendChild(t)}))}))})),t}(e);break;case"Товары ABC - анализ":t=d(e)}return t}(r);a.appendChild(o),t.appendChild(a)}(e))),t}async function o(e){const a=(new Date).toLocaleDateString();let s=JSON.parse(localStorage.getItem("reports")),i=localStorage.getItem("reportIndex");i||(i=0,localStorage.setItem("reportIndex","0"));const n=e.target.closest(".report-block_modal"),c=n.getAttribute("id").slice(0,-5),d=n.querySelector('[id^="report-select"]').value,r=n.querySelector('[id^="period-select"]').value;let o=n.querySelector(".year-first").value,v=n.querySelector(".year-last").value;""!==o&&""!==v||(o=(new Date).getFullYear()-1,v=(new Date).getFullYear()-1);const _=n.querySelector('[id^="parameter-select"]').value;n.style.display="none";const p=`report/${c}/${d}/${r}/${_}/${o}/${v}`,u=await t(p);i=Number(i)+1,s?s.push({id:i,date:a,report:u}):s=[{id:i,date:a,report:u}],localStorage.setItem("reports",JSON.stringify(s)),localStorage.setItem("reportIndex",i.toString()),document.querySelector(".report-list").insertAdjacentElement("beforeend",l({id:i,date:a,report:u}))}const v=document.querySelector("#customer-report"),_=document.querySelector("#goods-report"),p=document.querySelector("#money-arguments"),u=document.querySelector("#time-arguments"),g=document.querySelector("#customerModal"),b=document.querySelector("#goodsModal"),m=document.querySelectorAll(".dropdown__input"),h=g.querySelectorAll("li"),y=b.querySelectorAll("li");!function(){const e=document.querySelector(".report-list"),t=JSON.parse(localStorage.getItem("reports"));t&&t.forEach((t=>{e.insertAdjacentElement("beforeend",l(t))}))}(),u.querySelectorAll("li").forEach((e=>{e.addEventListener("click",(e=>a(e.target)))})),p.querySelectorAll("li").forEach((e=>{e.addEventListener("click",(e=>a(e.target)))})),m.forEach((e=>{const t=e.closest(".dropdown");e.addEventListener("click",(e=>function(e,t){e.contains(t.target)&&e.querySelector("ul").classList.add("visible")}(t,e)))})),y.forEach((e=>e.addEventListener("click",(e=>s(e.target))))),b.querySelector(".btn-close").addEventListener("click",(()=>b.style.display="none")),b.querySelector(".btn-save").addEventListener("mousedown",(e=>o(e))),h.forEach((e=>e.addEventListener("click",(e=>s(e.target))))),g.querySelector(".btn-close").addEventListener("click",(()=>g.style.display="none")),g.querySelector(".btn-save").addEventListener("mousedown",(e=>o(e))),v.addEventListener("click",(e=>{g.style.display="flex"})),_.addEventListener("click",(e=>{b.style.display="flex"}))})();